<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rasoa Pro - V2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, doc, updateDoc, deleteDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js";
        import { h, render } from 'https://esm.sh/preact';
        import { useState, useEffect, useMemo } from 'https://esm.sh/preact/hooks';
        import htm from 'https://esm.sh/htm';

        const html = htm.bind(h);

        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'rasoa-pro-v2';
        
        const LOGO_URL = "https://lh3.googleusercontent.com/u/0/d/14wx6DlgO3bZ6rSIhQQz6wRzlLrBgwNAp=w1000-h1000";

        const FBIcon = () => html`<svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>`;
        const TTIcon = () => html`<svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor"><path d="M12.525.02c1.31 0 2.568.27 3.685.75V4.74c-1.12-.66-2.42-1.04-3.81-1.04H12.4v13.67c0 2.4-1.95 4.35-4.35 4.35S3.7 19.77 3.7 17.37s1.95-4.35 4.35-4.35c.42 0 .82.06 1.19.17V9.43c-.39-.03-.78-.05-1.19-.05-4.47 0-8.1 3.63-8.1 8.1s3.63 8.1 8.1 8.1 8.1-3.63 8.1-8.1V0h.475c1.11 0 2.16.27 3.1.75V4.74c-.94-.48-1.99-.75-3.1-.75h-.475V0h.475z"/></svg>`;
        const SmileIcon = () => html`<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"><path d="M14.828 14.828a4 4 0 01-5.656 0" stroke-linecap="round"/><circle cx="9" cy="9" r="1.5" fill="currentColor" stroke="none"/><circle cx="15" cy="9" r="1.5" fill="currentColor" stroke="none"/><circle cx="12" cy="12" r="10"/></svg>`;
        const PackageIcon = () => html`<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/></svg>`;

        function App() {
            const [user, setUser] = useState(null);
            const [isAdmin, setIsAdmin] = useState(false);
            const [password, setPassword] = useState("");
            const [activeTab, setActiveTab] = useState("commandes");
            const [loading, setLoading] = useState(false);
            const [authLoading, setAuthLoading] = useState(true);

            const [clients, setClients] = useState([]);
            const [livraisons, setLivraisons] = useState([]);
            const [depenses, setDepenses] = useState([]);

            const [searchTerm, setSearchTerm] = useState("");
            const [orderForm, setOrderForm] = useState({ nom: "", telephone: "", montant: "", lieu: "", source: "Facebook", remarque: "", isColis: false });
            const [clientForm, setClientForm] = useState({ nom: "", telephone: "", lieu: "", source: "Facebook", remarque: "" });
            const [depenseForm, setDepenseForm] = useState({ motif: "", montant: "" });

            useEffect(() => {
                const initAuth = async () => {
                    try {
                        if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                            await signInWithCustomToken(auth, __initial_auth_token);
                        } else {
                            await signInAnonymously(auth);
                        }
                    } catch (e) { console.error(e); } finally { setAuthLoading(false); }
                };
                initAuth();
                return onAuthStateChanged(auth, setUser);
            }, []);

            useEffect(() => {
                if (!user) return;
                const getCol = (name) => collection(db, 'artifacts', appId, 'public', 'data', name);
                const unsubLiv = onSnapshot(getCol('livraisons'), (s) => setLivraisons(s.docs.map(d => ({ id: d.id, ...d.data() }))));
                const unsubCli = onSnapshot(getCol('clients'), (s) => setClients(s.docs.map(d => ({ id: d.id, ...d.data() }))));
                const unsubDep = onSnapshot(getCol('depenses'), (s) => setDepenses(s.docs.map(d => ({ id: d.id, ...d.data() }))));
                return () => { unsubLiv(); unsubCli(); unsubDep(); };
            }, [user]);

            const stats = useMemo(() => {
                const totalVentesLivrees = livraisons.filter(l => l.statut === "Livré").reduce((acc, curr) => acc + (Number(curr.montant) || 0), 0);
                const totalDepenses = depenses.reduce((acc, curr) => acc + (Number(curr.montant) || 0), 0);
                return { entrees: totalVentesLivrees, depenses: totalDepenses, solde: totalVentesLivrees - totalDepenses };
            }, [livraisons, depenses]);

            const filteredClients = useMemo(() => {
                if (!searchTerm || searchTerm.length < 1) return [];
                return clients.filter(c => 
                    (c.nom && c.nom.toLowerCase().includes(searchTerm.toLowerCase())) || 
                    (c.telephone && c.telephone.includes(searchTerm))
                );
            }, [searchTerm, clients]);

            const handleLogin = () => {
                if (password === "rasoa123") { setIsAdmin(true); setPassword(""); }
                else { alert("Mot de passe incorrect"); }
            };

            const addOrder = async () => {
                if (!orderForm.nom || !orderForm.montant) return;
                setLoading(true);
                try {
                    await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'livraisons'), {
                        ...orderForm,
                        montant: Number(orderForm.montant),
                        statut: "Préparation",
                        timestamp: serverTimestamp(),
                        date: new Date().toLocaleDateString('fr-FR')
                    });
                    if (!clients.find(c => c.telephone === orderForm.telephone)) {
                        await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'clients'), {
                            nom: orderForm.nom,
                            telephone: orderForm.telephone,
                            lieu: orderForm.lieu,
                            source: orderForm.source,
                            remarque: orderForm.remarque,
                            timestamp: serverTimestamp()
                        });
                    }
                    setOrderForm({ nom: "", telephone: "", montant: "", lieu: "", source: "Facebook", remarque: "", isColis: false });
                    setActiveTab("livraisons");
                } finally { setLoading(false); }
            };

            const addManualClient = async () => {
                if (!clientForm.nom || !clientForm.telephone) return;
                await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'clients'), {
                    ...clientForm,
                    timestamp: serverTimestamp()
                });
                setClientForm({ nom: "", telephone: "", lieu: "", source: "Facebook", remarque: "" });
            };

            const addDepense = async () => {
                if (!depenseForm.motif || !depenseForm.montant) return;
                await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'depenses'), { 
                    ...depenseForm, 
                    montant: Number(depenseForm.montant), 
                    timestamp: serverTimestamp(),
                    date: new Date().toLocaleDateString('fr-FR')
                });
                setDepenseForm({ motif: "", montant: "" });
            };

            const updateStatus = async (id, current) => {
                const next = current === "Préparation" ? "Livraison" : "Livré";
                await updateDoc(doc(db, 'artifacts', appId, 'public', 'data', 'livraisons', id), { statut: next });
            };

            const deleteItem = async (col, id) => {
                if (confirm("Supprimer définitivement ?")) await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', col, id));
            };

            if (authLoading) return html`<div class="flex items-center justify-center min-h-screen font-black text-indigo-600 bg-white uppercase">Chargement de la base...</div>`;

            if (!isAdmin) return html`
                <div class="flex items-center justify-center min-h-screen bg-slate-950 p-4 relative overflow-hidden">
                    <div class="absolute inset-0 opacity-20 pointer-events-none">
                         <div class="absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-indigo-500 rounded-full blur-[120px]"></div>
                         <div class="absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-blue-500 rounded-full blur-[120px]"></div>
                    </div>
                    <button onClick=${() => setIsAdmin(true)} class="absolute top-8 right-8 opacity-20 hover:opacity-100 transition-all text-white"><${SmileIcon} /></button>
                    <div class="bg-white/95 backdrop-blur-xl p-10 rounded-[3.5rem] w-full max-w-sm text-center shadow-2xl relative z-10">
                        <img src=${LOGO_URL} class="w-24 h-24 rounded-full mx-auto mb-8 object-cover border-4 border-white shadow-xl" />
                        <h1 class="font-black text-2xl text-slate-900 mb-8 uppercase tracking-tighter">Rasoa <span class="text-indigo-600">Pro</span></h1>
                        <input type="password" placeholder="Mot de passe" class="w-full p-4 bg-slate-100 rounded-2xl text-center font-bold mb-6 outline-none focus:ring-2 focus:ring-indigo-500"
                               value=${password} onInput=${e => setPassword(e.target.value)} onKeyDown=${e => e.key === 'Enter' && handleLogin()} />
                        <button onClick=${handleLogin} class="w-full bg-indigo-600 text-white py-4 rounded-2xl font-black uppercase shadow-xl hover:bg-indigo-700 active:scale-95 transition-all">Accéder</button>
                    </div>
                </div>
            `;

            return html`
                <div class="min-h-screen bg-slate-50 relative flex flex-col pb-20 text-slate-900 overflow-x-hidden">
                    <!-- Fond Stylisé -->
                    <div class="fixed inset-0 pointer-events-none overflow-hidden z-0">
                         <div class="absolute top-[-20%] left-[-10%] w-[60%] h-[60%] bg-indigo-100 rounded-full blur-[150px] opacity-50"></div>
                         <div class="absolute bottom-[-20%] right-[-10%] w-[60%] h-[60%] bg-blue-100 rounded-full blur-[150px] opacity-50"></div>
                    </div>

                    <nav class="bg-white/80 backdrop-blur-md border-b px-6 h-20 flex items-center justify-between sticky top-0 z-50">
                        <div class="flex items-center gap-3 font-black text-xl tracking-tighter uppercase">
                            <img src=${LOGO_URL} class="w-10 h-10 rounded-full border shadow-sm" />
                            <span class="text-indigo-600">Rasoa Pro</span>
                        </div>
                        <button onClick=${() => setIsAdmin(false)} class="text-slate-400 font-bold text-[10px] uppercase border px-4 py-2 rounded-full hover:bg-slate-50 bg-white">Déconnexion</button>
                    </nav>

                    <div class="bg-white/80 backdrop-blur-md border-b sticky top-20 z-40 overflow-x-auto no-scrollbar shadow-sm">
                        <div class="max-w-5xl mx-auto flex">
                            ${[{id: 'commandes', label: 'Vente'}, {id: 'livraisons', label: 'Livraisons'}, {id: 'finances', label: 'Dépenses'}, {id: 'clients', label: 'Clients'}].map(t => html`
                                <button onClick=${() => setActiveTab(t.id)} class="px-8 py-5 border-b-2 font-black text-[10px] uppercase transition-all ${activeTab === t.id ? 'border-indigo-600 text-indigo-600 bg-indigo-50/50' : 'border-transparent text-slate-400'}">
                                    ${t.label}
                                </button>
                            `)}
                        </div>
                    </div>

                    <main class="max-w-5xl mx-auto w-full p-4 md:p-8 relative z-10">
                        ${activeTab === 'commandes' && html`
                            <div class="max-w-lg mx-auto bg-white rounded-[2.5rem] p-8 shadow-xl border border-white/50 space-y-5">
                                <h2 class="text-lg font-black uppercase text-center text-slate-800">Nouvelle Commande</h2>
                                <div class="relative">
                                    <input value=${searchTerm} onInput=${e => setSearchTerm(e.target.value)} placeholder="Rechercher un client..." class="w-full p-4 bg-slate-50 rounded-2xl border-none font-bold outline-none focus:ring-2 focus:ring-indigo-100" />
                                    ${filteredClients.length > 0 && html`
                                        <div class="absolute z-10 w-full mt-2 bg-white border rounded-2xl shadow-2xl max-h-40 overflow-y-auto">
                                            ${filteredClients.map(c => html`
                                                <div onClick=${() => { setOrderForm({...orderForm, nom: c.nom, telephone: c.telephone, lieu: c.lieu, source: c.source || 'Facebook', remarque: c.remarque || ''}); setSearchTerm(""); }} 
                                                     class="p-4 hover:bg-indigo-50 cursor-pointer font-bold border-b text-sm last:border-0">${c.nom} (${c.telephone})</div>
                                            `)}
                                        </div>
                                    `}
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <input value=${orderForm.nom} onInput=${e => setOrderForm({...orderForm, nom: e.target.value})} placeholder="Nom Client" class="p-4 bg-slate-50 rounded-2xl font-bold outline-none" />
                                    <input value=${orderForm.telephone} onInput=${e => setOrderForm({...orderForm, telephone: e.target.value})} placeholder="Tél" class="p-4 bg-slate-50 rounded-2xl font-bold outline-none" />
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <input value=${orderForm.lieu} onInput=${e => setOrderForm({...orderForm, lieu: e.target.value})} placeholder="Quartier/Ville" class="p-4 bg-slate-50 rounded-2xl font-bold outline-none" />
                                    <div class="flex gap-1 p-1 bg-slate-100 rounded-2xl">
                                        <button onClick=${() => setOrderForm({...orderForm, source: 'Facebook'})} class="flex-1 flex items-center justify-center py-3 rounded-xl transition-all ${orderForm.source === 'Facebook' ? 'bg-blue-600 text-white shadow-md' : 'text-slate-400'}"><${FBIcon} /></button>
                                        <button onClick=${() => setOrderForm({...orderForm, source: 'TikTok'})} class="flex-1 flex items-center justify-center py-3 rounded-xl transition-all ${orderForm.source === 'TikTok' ? 'bg-slate-900 text-white shadow-md' : 'text-slate-400'}"><${TTIcon} /></button>
                                    </div>
                                </div>
                                <div class="p-4 bg-slate-50 rounded-2xl flex items-center justify-between">
                                    <span class="text-[10px] font-black uppercase text-slate-500">Livraison Colis ?</span>
                                    <input type="checkbox" checked=${orderForm.isColis} onChange=${e => setOrderForm({...orderForm, isColis: e.target.checked})} class="w-5 h-5 accent-indigo-600 cursor-pointer" />
                                </div>
                                <input type="number" value=${orderForm.montant} onInput=${e => setOrderForm({...orderForm, montant: e.target.value})} placeholder="Montant Ar" class="w-full p-5 bg-indigo-50 rounded-2xl font-black text-3xl text-indigo-600 text-center outline-none" />
                                <textarea value=${orderForm.remarque} onInput=${e => setOrderForm({...orderForm, remarque: e.target.value})} placeholder="Remarque..." class="w-full p-4 bg-slate-50 rounded-2xl font-bold outline-none min-h-[80px] text-sm"></textarea>
                                <button onClick=${addOrder} class="w-full bg-slate-900 text-white py-5 rounded-2xl font-black uppercase shadow-xl hover:bg-indigo-600 active:scale-95 transition-all">Valider la vente</button>
                            </div>
                        `}

                        ${activeTab === 'livraisons' && html`
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                ${livraisons.length === 0 && html`<div class="col-span-full text-center py-20 text-slate-300 font-black uppercase text-xs">Aucune livraison</div>`}
                                ${livraisons.sort((a,b) => b.timestamp - a.timestamp).map(l => html`
                                    <div class="bg-white rounded-[2rem] border p-6 shadow-sm hover:shadow-lg transition-all relative overflow-hidden group">
                                        ${l.isColis && html`<div class="absolute top-4 right-4 bg-indigo-600 text-white px-3 py-1 rounded-full text-[8px] font-black uppercase flex items-center gap-1 shadow-lg shadow-indigo-100"><${PackageIcon} /> Colis</div>`}
                                        <div class="text-[9px] font-black uppercase text-slate-400 mb-4">${l.date} • ${l.statut}</div>
                                        <h3 class="font-black text-lg mb-1 group-hover:text-indigo-600 transition-colors">${l.nom}</h3>
                                        <p class="text-xs text-indigo-600 font-black mb-3">${l.telephone}</p>
                                        <p class="text-[10px] text-slate-500 font-bold mb-3 uppercase tracking-tight">Destination: ${l.lieu}</p>
                                        ${l.remarque && html`<div class="p-3 bg-slate-50 rounded-xl text-[10px] font-medium text-slate-500 italic mb-4 border-l-2 border-indigo-200">${l.remarque}</div>`}
                                        <div class="flex justify-between items-center border-t pt-4">
                                            <span class="font-black text-indigo-600 text-lg">${Number(l.montant || 0).toLocaleString()} Ar</span>
                                            <div class="flex gap-2">
                                                <button onClick=${() => deleteItem('livraisons', l.id)} class="p-2 text-slate-200 hover:text-red-500 transition-colors">X</button>
                                                ${l.statut !== 'Livré' && html`<button onClick=${() => updateStatus(l.id, l.statut)} class="bg-indigo-600 text-white px-5 py-2 rounded-xl text-[10px] font-black uppercase shadow-md active:scale-95 transition-all">${l.statut === 'Préparation' ? 'Envoyer' : 'Confirmer'}</button>`}
                                            </div>
                                        </div>
                                    </div>
                                `)}
                            </div>
                        `}

                        ${activeTab === 'finances' && html`
                            <div class="space-y-6">
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div class="bg-white/80 backdrop-blur-sm p-8 rounded-[2rem] border shadow-sm text-center">
                                        <div class="text-[9px] font-black text-slate-400 uppercase mb-2">Total Entrées</div>
                                        <div class="text-xl font-black text-green-600">${stats.entrees.toLocaleString()} Ar</div>
                                    </div>
                                    <div class="bg-white/80 backdrop-blur-sm p-8 rounded-[2rem] border shadow-sm text-center">
                                        <div class="text-[9px] font-black text-slate-400 uppercase mb-2">Total Dépenses</div>
                                        <div class="text-xl font-black text-red-600">${stats.depenses.toLocaleString()} Ar</div>
                                    </div>
                                    <div class="bg-indigo-600 p-8 rounded-[2rem] text-white shadow-xl shadow-indigo-200 text-center">
                                        <div class="text-[9px] font-black uppercase mb-2 opacity-60">Solde Actuel</div>
                                        <div class="text-2xl font-black">${stats.solde.toLocaleString()} Ar</div>
                                    </div>
                                </div>
                                <div class="bg-white rounded-[2.5rem] border p-8 shadow-sm">
                                    <h3 class="font-black uppercase text-[10px] text-slate-400 mb-6 tracking-widest text-center">Enregistrer une dépense</h3>
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <input value=${depenseForm.motif} onInput=${e => setDepenseForm({...depenseForm, motif: e.target.value})} placeholder="Motif de la dépense" class="p-4 bg-slate-50 rounded-2xl font-bold outline-none" />
                                        <input type="number" value=${depenseForm.montant} onInput=${e => setDepenseForm({...depenseForm, montant: e.target.value})} placeholder="Montant Ar" class="p-4 bg-slate-50 rounded-2xl font-bold outline-none text-red-500" />
                                        <button onClick=${addDepense} class="bg-slate-900 text-white py-4 rounded-2xl font-black uppercase text-[10px] shadow-lg active:scale-95 transition-all">Ajouter</button>
                                    </div>
                                </div>
                                <div class="bg-white rounded-[2rem] border overflow-hidden shadow-sm">
                                    <div class="p-6 bg-slate-50 border-b text-[10px] font-black uppercase text-slate-400">Historique complet</div>
                                    <div class="overflow-x-auto">
                                        <table class="w-full text-left">
                                            <tbody class="divide-y font-bold">
                                                ${depenses.sort((a,b) => b.timestamp - a.timestamp).map(d => html`
                                                    <tr class="hover:bg-slate-50 transition-colors">
                                                        <td class="p-6 text-slate-400 text-xs">${d.date}</td>
                                                        <td class="p-6 uppercase text-sm">${d.motif}</td>
                                                        <td class="p-6 text-red-500 font-black text-right">${Number(d.montant).toLocaleString()} Ar</td>
                                                        <td class="p-6 text-right"><button onClick=${() => deleteItem('depenses', d.id)} class="text-slate-200 hover:text-red-500">Effacer</button></td>
                                                    </tr>
                                                `)}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        `}

                        ${activeTab === 'clients' && html`
                            <div class="space-y-6">
                                <!-- AJOUT MANUEL DE CLIENT RÉINTRODUIT ICI -->
                                <div class="bg-white rounded-[2.5rem] border p-8 shadow-sm">
                                    <h3 class="font-black uppercase text-[10px] text-slate-400 mb-6 tracking-widest text-center">Ajouter un nouveau client</h3>
                                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                        <input value=${clientForm.nom} onInput=${e => setClientForm({...clientForm, nom: e.target.value})} placeholder="Nom complet" class="p-4 bg-slate-50 rounded-2xl font-bold outline-none text-sm" />
                                        <input value=${clientForm.telephone} onInput=${e => setClientForm({...clientForm, telephone: e.target.value})} placeholder="Téléphone" class="p-4 bg-slate-50 rounded-2xl font-bold outline-none text-sm" />
                                        <input value=${clientForm.lieu} onInput=${e => setClientForm({...clientForm, lieu: e.target.value})} placeholder="Quartier/Ville" class="p-4 bg-slate-50 rounded-2xl font-bold outline-none text-sm" />
                                        <div class="flex gap-1 p-1 bg-slate-100 rounded-2xl">
                                            <button onClick=${() => setClientForm({...clientForm, source: 'Facebook'})} class="flex-1 flex items-center justify-center rounded-xl py-2 ${clientForm.source === 'Facebook' ? 'bg-blue-600 text-white shadow-sm' : 'text-slate-400'}"><${FBIcon} /></button>
                                            <button onClick=${() => setClientForm({...clientForm, source: 'TikTok'})} class="flex-1 flex items-center justify-center rounded-xl py-2 ${clientForm.source === 'TikTok' ? 'bg-slate-900 text-white shadow-sm' : 'text-slate-400'}"><${TTIcon} /></button>
                                        </div>
                                    </div>
                                    <div class="mt-4 flex flex-col md:flex-row gap-4">
                                        <textarea value=${clientForm.remarque} onInput=${e => setClientForm({...clientForm, remarque: e.target.value})} placeholder="Remarque ou notes..." class="flex-1 p-4 bg-slate-50 rounded-2xl font-bold outline-none text-sm min-h-[60px]"></textarea>
                                        <button onClick=${addManualClient} class="md:w-48 bg-indigo-600 text-white py-4 rounded-2xl font-black uppercase text-[10px] shadow-lg active:scale-95 transition-all">Enregistrer</button>
                                    </div>
                                </div>

                                <div class="bg-white rounded-[2rem] border overflow-hidden shadow-sm">
                                    <div class="overflow-x-auto">
                                        <table class="w-full text-left">
                                            <thead class="bg-slate-50 text-[10px] font-black uppercase text-slate-400 border-b">
                                                <tr><th class="p-6">Client</th><th class="p-6">Contact</th><th class="p-6">Localisation</th><th class="p-6">Source</th><th class="p-6 text-right">Action</th></tr>
                                            </thead>
                                            <tbody class="divide-y font-bold">
                                                ${clients.sort((a,b) => (a.nom || "").localeCompare(b.nom || "")).map(c => html`
                                                    <tr class="hover:bg-slate-50 transition-colors">
                                                        <td class="p-6">
                                                            <div>${c.nom}</div>
                                                            <div class="text-[9px] text-slate-400 font-normal italic">${c.remarque || ''}</div>
                                                        </td>
                                                        <td class="p-6 text-indigo-600">${c.telephone}</td>
                                                        <td class="p-6 text-[10px] uppercase opacity-70">${c.lieu || '-'}</td>
                                                        <td class="p-6">
                                                            ${c.source === 'TikTok' ? html`<${TTIcon} class="text-slate-900 opacity-30"/>` : html`<${FBIcon} class="text-blue-600 opacity-40"/>`}
                                                        </td>
                                                        <td class="p-6 text-right">
                                                            <button onClick=${() => deleteItem('clients', c.id)} class="text-slate-200 hover:text-red-500">X</button>
                                                        </td>
                                                    </tr>
                                                `)}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        `}
                    </main>
                </div>
            `;
        }

        render(html`<${App} />`, document.body);
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        input[type="number"]::-webkit-inner-spin-button, input[type="number"]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>
<body class="bg-slate-50"></body>
</html>
